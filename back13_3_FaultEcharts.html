<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="pragma" content="no-cache"/>
    <meta http-equiv="Cache-Control" content="no-cache"/>
    <meta http-equiv="Expires" content="0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="assets/css/bootstrap.min.css?v=1.0.0" rel="stylesheet" />
    <link rel="stylesheet" href="css/style.css?v=1.0.0"/>
    <link href="assets/css/codemirror.css?v=1.0.0" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/ace.min.css?v=1.0.0" />
    <link rel="stylesheet" href="assets/css/font-awesome.min.css?v=1.0.0" />
    <link rel="stylesheet" href="font/css/font-awesome.min.css?v=1.0.0" />
    <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css?v=1.0.0" />
    <script src="assets/js/jquery.min.js?v=1.0.0"></script>
    <link rel="stylesheet" href="assets/css/ace-ie.min.css?v=1.0.0" />
    <link rel="stylesheet" href="assets/layui/css/layui.css?v=1.0.0" />
    <link rel="stylesheet" href="css/power/manager.css?v=1.0.0" />
    <link rel="stylesheet" href="css/power/base.css?v=1.0.0" />
    <script src="assets/js/typeahead-bs2.min.js?v=1.0.0"></script>
    <script src="assets/layer/layer.js?v=1.0.0" type="text/javascript" ></script>
    <script src="js/echarts4.min.js?v=1.0.0"></script>
    <title>报警信息</title>
    <style type="text/css">
        *{
            font-family: Arial, "微软雅黑";
        }
        .content_left{
            width: 340px;
            height: 100%;
            background-color: lightgrey;
            float: left;
            padding: 10px;
            margin: 10px;
            /* height: 800px; */
            background: white;
            /* border: solid 2px red; */
            box-shadow: 2px 2px 6px #ccc;
        }
        .content_right{
            /* height: 800px; */
            padding: 10px;
            background: white;
        }
        p,label{
            font-size: 16px;
            line-height: 15px;
            padding-top: 5px;
        }

        .line_title {
            width: 100%;
            height: 50px;
            line-height: 50px;
            margin: 0;
        }
        .navigation_l li {
            height: 40px;
            line-height: 40px;
            display: inline-block;
        }
        .back:hover,
        .back {
            display: inline-block;
            width: 60px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            background: #f0854e;
            color: white !important;
            border-radius: 3px;
            margin-right: 20px;
            transform: translateY(4px);
        }
        body {background-color: #f9f6f1;}
        .clearfloat {height:0;clear:both;visibility:hidden}
        .pDiv {background-color: #fff;padding-bottom: 20px;}
    </style>
</head>
<body >

<div style="width: 100%" class="pDiv">
    <div class="line_title">
        <ul class="navigation_l">
            <li id="first_li">
                <a href="javascript:void(0);" class="back" id="btn-2">
                < 返回</a>
            </li>
          <!--  <li>
                <a href="back8_0_FaultGround.html">报警信息</a>
                <span>></span>
            </li>-->
            <li>
                <a class="stationName" href="javascript:void(0);">报警详情</a>
                <!--<span>></span>-->
            </li>
        </ul>
    </div>

    <div class="content_left">
        <label style="height: 30px; line-height: 50px;">故障信息</label>
        <hr>
        <div style="width: 100%;height: 50px; line-height: 50px;text-align: center; border-bottom: solid 1px #ccc; color: #2494f9; font-size: 36px;">
            <img src="images/two/15.1.png" alt="" style="width: 30px; height: 30px; transform: translateY(-6px);">
            <label style="text-align: center;" id="type"></label>
        </div>

        <div style="width: 100%;height: 100px; border-bottom: solid 1px #ccc;padding:10px;">
            <img src="images/two/15.2.png" alt="" style="width: 15px; height: 15px; transform: translateY(-6px); display: inline-block;">
            <div style="display: inline-block;" id="masterName"></div>
            <p id="masterAddress"></p>
        </div>

        <div style="width: 100%;position: relative">
            <img src="images/two/15.3.png" alt="" style="width: 15px; height: 15px; display: inline-block;">
            <div style="height: 45px; line-height: 40px; display: inline-block;">报警处理</div>
            <!-- <div style="width:60px;height: 90%;border: solid 1px #0d957a;float: left">

            </div> -->
            <div style="width: 100%;padding: 20px 0 20px 20px;">
                <ul id="FaultGroundInfoList">
                   <!-- <li style="border-left:solid 1px #2494f9; position: relative; padding-left: 20px;">
                       <span style="width: 10px; height: 10px; display: inline-block; background: #2494f9; border-radius:50%; position: absolute; top: -5px; left: -5px;"></span>
                       <p>故障发生</p>
                       <label>张三</label><label>2017-06-12   08:12:34</label>
                    </li>
                    <li style="border-left:solid 1px #2494f9; position: relative; padding-left: 20px;">
                        <span style="width: 10px; height: 10px; display: inline-block; background: #2494f9; border-radius:50%; position: absolute; top: -5px; left: -5px;"></span>
                        <p>经巡视发现是有鸟筑巢衔铁丝发生单相接地故障，故障点隔离不影响正常运行</p>
                        <label>张三</label><label>2017-06-12   08:12:34</label>
                    </li>
                    <li style="position: relative; padding-left: 20px;">
                        <span style="width: 10px; height: 10px; display: inline-block; background: #2494f9; border-radius:50%; position: absolute; top: -5px; left: -5px;"></span>
                        <p>解除警报</p>
                        <label>张三</label><label>2017-06-12   08:12:34</label>
                    </li>-->
                </ul>

            </div>
        </div>

    </div>


    <div class="content_right" id="Statistics">
        <label style="display:inline-block;width: 100px;height: 20px;">故障波形</label>
        <div id="mains_one" style="height:300px; overflow:hidden; display: block" ></div>
        <div id="mains_two" style="height:300px; overflow:hidden; display: block" ></div>
    </div>
    <div class="clearfloat"></div>
</div>


</body>
</html>
<script src="js/common.js?v=1.0.1"></script>
<script>

    var devid = getPropetyVal('devid')

    var autoId = getPropetyVal('autoId')
//    alert(devid)
//    alert(autoId)
    var type = decodeURI(getPropetyVal('type'));
    var masterName = decodeURI(getPropetyVal('masterName'));
    var masterAddress = decodeURI(getPropetyVal('masterAddress'));
    var times = getPropetyVal('times')
    var monitorFlag = getPropetyVal('monitorFlag')
    var isSolve_ = getPropetyVal('isSolve_')

    $('#btn-2').on('click', function(){
//        alert(999)
        window.parent.$("#iframepage").attr("src", 'back13_1_line_masterFaultInfo.html?v=1.0.0&monitorFlag='+monitorFlag+'&isSolve='+isSolve_);
    })

    $('#type').text(type);
    $('#masterName').text(masterName);
    $('#masterAddress').text(masterAddress);

//    autoId = 50;
    var data = {autoId:autoId,deviceId:devid}
    queryFaultGroundInfoList(data);
    function queryFaultGroundInfoList(data) {
        POST("/eric/queryFaultGroundInfoList.v1", data, function (res) {
            if (res.code == '0') {
                var dataList = res.data.list;
                var  html = '';
                for (var i = 0;i<dataList.length; i++) {
                    html += '<li style="border-left:solid 1px #2494f9; position: relative; padding-left: 20px;">' +
                            '<span style="width: 10px; height: 10px; display: inline-block; background: #2494f9; border-radius:50%; position: absolute; top: -5px; left: -5px;"></span>' +
                            '<label style="WORD-BREAK: break-all; WORD-WRAP: break-word">'+dataList[i].recordMessage+'</label>'+
                            '<label>'+dataList[i].createByName+'&nbsp;&nbsp;&nbsp;</label>'+
                            '<label>'+dataList[i].createTime+'</label>'+
                            '</li>';
                }
                $('#FaultGroundInfoList').append(html);
            }
        });
    }

    // 年月日统计表格
    var xAxis_voltage_name=[-200,-180,-160,-140,-120,-100,-80,-60,-40,-20,0,20,40,60,80,100,120,140,160,180,200];
    var xAxis_Wave_UA=[];
    var xAxis_Wave_UB=[];
    var xAxis_Wave_UC=[];
    var xAxis_Wave_U0=[];

    var xAxis_Electric_name=[-200,-180,-160,-140,-120,-100,-80,-60,-40,-20,0,20,40,60,80,100,120,140,160,180,200];
    var xAxis_Wave_IA=[];
    var xAxis_Wave_IB=[];
    var xAxis_Wave_IC=[];
    var xAxis_Wave_IX=[];



    function  getStatisticsData(){
        var data = {devid:devid,time:'2018-05-26 01:00:00:000'};
         xAxis_Wave_UA=[];
         xAxis_Wave_UB=[];
         xAxis_Wave_UC=[];
         xAxis_Wave_U0=[];

         xAxis_Wave_IA=[];
         xAxis_Wave_IB=[];
         xAxis_Wave_IC=[];
         xAxis_Wave_IX=[];
        POST("/eric/getFaultOverVoltage.v1", data, function (res) {
            if (res.code == '0') {
                var day_Arr = res.data;
                if(day_Arr != null){

                    // 电压
                    var Wave_UA_strs = JSON.stringify(day_Arr['Wave_UA']);
                    var Wave_UA_Arr=Wave_UA_strs.substring(1,Wave_UA_strs.length-1).split(",");
                    for(var i=0;i<Wave_UA_Arr.length;i++){
                        xAxis_Wave_UA.push(parseFloat(Wave_UA_Arr[i]));
                    }

                    var Wave_UB_strs = JSON.stringify(day_Arr['Wave_UB']);
                    var Wave_UB_Arr=Wave_UB_strs.substring(1,Wave_UA_strs.length-1).split(",");
                    for(var i=0;i<Wave_UB_Arr.length;i++){
                        xAxis_Wave_UB.push(parseFloat(Wave_UB_Arr[i]));
                    }

                    var Wave_UC_strs = JSON.stringify(day_Arr['Wave_UC']);
                    var Wave_UC_Arr=Wave_UC_strs.substring(1,Wave_UA_strs.length-1).split(",");
                    for(var i=0;i<Wave_UC_Arr.length;i++){
                        xAxis_Wave_UC.push(parseFloat(Wave_UC_Arr[i]));
                    }

                    var Wave_U0_strs = JSON.stringify(day_Arr['Wave_U0']);
                    var Wave_U0_Arr=Wave_U0_strs.substring(1,Wave_UA_strs.length-1).split(",");
                    for(var i=0;i<Wave_U0_Arr.length;i++){
                        xAxis_Wave_U0.push(parseFloat(Wave_U0_Arr[i]));
                    }

                    // 电流
                    var Wave_IA_strs = JSON.stringify(day_Arr['Wave_IA']);
                    var Wave_IA_Arr=Wave_IA_strs.substring(1,Wave_IA_strs.length-1).split(",");
                    for(var i=0;i<Wave_IA_Arr.length;i++){
                        xAxis_Wave_IA.push(parseFloat(Wave_IA_Arr[i]));
                    }

                    var Wave_IB_strs = JSON.stringify(day_Arr['Wave_IB']);
                    var Wave_IB_Arr=Wave_IB_strs.substring(1,Wave_IA_strs.length-1).split(",");
                    for(var i=0;i<Wave_IB_Arr.length;i++){
                        xAxis_Wave_IB.push(parseFloat(Wave_IB_Arr[i]));
                    }

                    var Wave_IC_strs = JSON.stringify(day_Arr['Wave_IC']);
                    var Wave_IC_Arr=Wave_IC_strs.substring(1,Wave_IC_strs.length-1).split(",");
                    for(var i=0;i<Wave_IC_Arr.length;i++){
                        xAxis_Wave_IC.push(parseFloat(Wave_IC_Arr[i]));
                    }

                    var Wave_IX_strs = JSON.stringify(day_Arr['Wave_IX']);
                    var Wave_IX_Arr=Wave_IX_strs.substring(1,Wave_IX_strs.length-1).split(",");
                    for(var i=0;i<Wave_IX_Arr.length;i++){
                        xAxis_Wave_IX.push(parseFloat(Wave_IX_Arr[i]));
                    }

                }

            }
        });
    }



    getStatisticsData();
    Statistics_btn(xAxis_Wave_UA,xAxis_Wave_UB,xAxis_Wave_UC,xAxis_Wave_U0,xAxis_Wave_IA,xAxis_Wave_IB,xAxis_Wave_IC,xAxis_Wave_IX);
    function Statistics_btn(xAxis_Wave_UA,xAxis_Wave_UB,xAxis_Wave_UC,xAxis_Wave_U0,xAxis_Wave_IA,xAxis_Wave_IB,xAxis_Wave_IC,xAxis_Wave_IX){
        var myChart_mains_one = echarts.init(document.getElementById('mains_one'));
        option_one = {
            color:['#FFCD2D', '#14AE68', '#FB1734', '#333'],
            title: {
                text: '电压谐波波形',
                x:'20',
                y:'0'
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data:['A相电压','B相电压','C相电压','3U0电压'],
                x:'20px',
                y:'30px'
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: xAxis_voltage_name
            },
            yAxis: {
                show:true,
                name : ' 电压(V)',
                nameLocation:'end',
                type: 'value',
                position: 'right',
                axisLabel : {
                    formatter: '{value} V'
                }
            },
            series: [
                {
                    name:'A相电压',
                    type:'line',
//                    clickable:true,
                    symbolSize:3,
                    data:xAxis_Wave_UA,
                    smooth: true
                },
                {
                    name:'B相电压',
                    type:'line',
                    data:xAxis_Wave_UB,
                    smooth: true
                },
                {
                    name:'C相电压',
                    type:'line',
                    data:xAxis_Wave_UC,
                    smooth: true
                },
                {
                    name:'3U0电压',
                    type:'line',
                    data:xAxis_Wave_U0,
                    smooth: true
                }
            ]
        };
        myChart_mains_one.setOption(option_one);

        var myChart_mains_two = echarts.init(document.getElementById('mains_two'));
        option_two = {
            color:['#FFCD2D', '#14AE68', '#FB1734', '#333'],
            title: {
                text: '电流谐波波形',
                x:'20',
                y:'0'
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data:['A相电流','B相电流','C相电流','3I0电流'],
                x:'20px',
                y:'30px'
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: xAxis_Electric_name
            },
            yAxis: {
                show:true,
                name : ' 电流(A)',
                nameLocation:'end',
                type: 'value',
                position: 'right',
                axisLabel : {
                    formatter: '{value} A'
                }
            },
            series: [
                {
                    name:'A相电流',
                    type:'line',
                    smooth: true,
                    symbolSize:3,
                    data:xAxis_Wave_IA
                },
                {
                    name:'B相电流',
                    type:'line',
                    smooth: true,
                    data:xAxis_Wave_IB
                },
                {
                    name:'C相电流',
                    type:'line',
                    smooth: true,
                    data:xAxis_Wave_IC
                },
                {
                    name:'3I0电流',
                    type:'line',
                    smooth: true,
                    data:xAxis_Wave_IX
                }
            ]
        };
        myChart_mains_two.setOption(option_two);
    }
</script>